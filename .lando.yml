name: mirror-twin-brewing
recipe: drupal8

config:
  php: "8.0"
  webroot: web
  xdebug: false
  database: "mariadb:10.4"

events:
  # Clear cache after a database import
  post-db-import:
    - appserver: cd $LANDO_WEBROOT && drush cache-rebuild --yes

services:
  appserver:
    run:
      - cd $LANDO_MOUNT && composer install

  nodejs:
    type: node:14
    globals:
      gulp-cli: latest

  phpmyadmin:
    type: phpmyadmin

  database:
    overrides:
        image: bitnami/mariadb:10.4.12

tooling:
  gulp:
    service: nodejs
  node:
    service: nodejs
  npm:
    service: nodejs
  phpunit:
    service: appserver
    cmd: vendor/bin/phpunit
  phpcs:
    service: appserver
    cmd: vendor/bin/phpcs
  security-check:
    service: appserver
    cmd: "php vendor/sensiolabs/security-checker/security-checker security:check composer.lock"
